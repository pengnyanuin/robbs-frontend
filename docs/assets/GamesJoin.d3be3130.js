import{_ as b,a as v,A as d,r as _,o as t,c as a,b as o,f as h,w as l,g,n as L,d as u,e as m,F as f,i as x,t as w,j as p}from"./index.75d0bc81.js";import{L as G}from"./Loader.07a570fa.js";import{_ as C}from"./refresh.d7839b6f.js";const N={name:"games_join",components:{Loader:G},data(){return{reloadLoading:!1,loading:!0,loadingMore:!1,error:!1,games:[],page:1,maxGames:0}},methods:{async mountedMethod(c){return await v.get(d.getApiUrl()+"games/open/"+this.page,d.getAuthHeader()).then(s=>{console.log(s.data),s.data.games&&this.games.push(...s.data.games),this.maxGames=s.data.numberOfPosts}).catch(async s=>{console.log(s),this.error=!0,s.response.status===401&&!c&&await d.refreshUser()&&await this.mountedMethod(!0)}).finally(()=>{this.loading=!1,this.reloadLoading=!1,this.loadingMore=!1}),!0},loadMore(){this.page++,this.loadingMore=!0,this.mountedMethod()},refreshGames(){this.page=1,this.games=[],this.error=!1,this.reloadLoading=!0,this.mountedMethod()}},mounted(){this.mountedMethod()},created(){d.isLoggedIn()||this.$router.push({name:"login"})}},j={class:"secondary-menu"},A=p("Join"),B=p("Joined"),V={class:"main-header"},J=o("h1",{class:"main-title"},"Open",-1),E=o("img",{src:C,alt:"refresh"},null,-1),F=[E],O=o("span",null,"New game",-1),R={class:"main-inner"},S={key:1,class:"notice"},U={key:2},z={key:0},D={class:"game__button__title"},H={key:1};function I(c,s,k,P,e,r){const i=_("router-link"),M=_("Loader");return t(),a(f,null,[o("div",j,[h(i,{to:{name:"games_join"},class:"btn"},{default:l(()=>[A]),_:1}),h(i,{to:{name:"games_joined"},class:"btn"},{default:l(()=>[B]),_:1})]),o("div",V,[J,o("a",{href:"#",onClick:s[0]||(s[0]=g((...n)=>r.refreshGames&&r.refreshGames(...n),["prevent"])),class:L(["btn-reload",{disabled:e.loading,loading:e.reloadLoading}])},F,2),h(i,{to:{name:"new_game"},class:"btn btn--danger"},{default:l(()=>[O]),_:1})]),o("div",R,[e.loading||e.reloadLoading||e.loadingMore?(t(),u(M,{key:0})):m("",!0),e.error?(t(),a("div",S," Error :c")):m("",!0),!e.loading&&!e.error?(t(),a("div",U,[e.games&&e.games.length?(t(),a("div",z,[(t(!0),a(f,null,x(e.games,(n,y)=>(t(),u(i,{to:{name:"game",params:{id:n.id}},key:y,class:"game__button"},{default:l(()=>[o("span",D,w(n.title),1)]),_:2},1032,["to"]))),128)),e.maxGames>e.games.length?(t(),a("a",{key:0,href:"#",onClick:s[1]||(s[1]=g((...n)=>r.loadMore&&r.loadMore(...n),["prevent"])),class:"btn mt-5"},"More")):m("",!0)])):(t(),a("div",H," Nothing ._. "))])):m("",!0)])],64)}const Q=b(N,[["render",I]]);export{Q as default};
