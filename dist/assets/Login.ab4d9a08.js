import{_ as c,A as a,a as g,r as p,o as n,c as l,b as f,w,d as o,e as i,f as d,v as u,g as k,h as y,t as _}from"./index.fa802337.js";const v={name:"login",data:()=>({loading:!0,loadingForm:!1,hasToken:!1,username:"",password:"",name:""}),methods:{async login(){this.loadingForm=!0;const s={username:this.username,password:this.password},e=await a.login(s);console.log(e),e&&Object.hasOwn(e,"token")&&Object.hasOwn(e,"refresh_token")&&this.$router.push({name:"welcome"}),this.loadingForm=!1},logout(){a.logout(),this.$router.go({name:"login"})},async axiosPlayerData(s){g.get(a.getApiUrl()+"player/data",a.getAuthHeader()).then(e=>{console.log(e.data),this.name=e.data.name}).catch(async e=>{console.log(e),e.response.status===401&&!s&&await a.refreshUser()&&await this.axiosPlayerData(!0)}).finally(()=>{this.loading=!1})}},created(){const s=a.getTokens();if(console.log(s),s&&Object.hasOwn(s,"token")&&Object.hasOwn(s,"refresh_token")){this.hasToken=!0,this.axiosPlayerData(!1);return}this.loading=!1}},b=o("h1",null,"LOGIN",-1),O={key:0,class:"loader"},N={key:1},T={key:0},V={class:"mt-3"},C=y(" Not you? "),D={key:1},j=o("button",{type:"submit",class:"btn"},"Login",-1),A={key:0,class:"loader"};function F(s,e,h,L,U,r){const m=p("router-link");return n(),l("div",null,[b,s.loading?(n(),l("div",O)):(n(),l("div",N,[s.hasToken?(n(),l("div",T,[f(m,{to:{name:"welcome"},class:"btn"},{default:w(()=>[o("span",null,"Continue as "+_(s.name),1)]),_:1}),o("div",V,[C,o("a",{href:"#",onClick:e[0]||(e[0]=i((...t)=>r.logout&&r.logout(...t),["prevent"]))},"Logout")])])):(n(),l("div",D,[o("form",{onSubmit:e[3]||(e[3]=i((...t)=>r.login&&r.login(...t),["prevent"]))},[o("p",null,[d(o("input",{"onUpdate:modelValue":e[1]||(e[1]=t=>s.username=t),placeholder:"username"},null,512),[[u,s.username]])]),o("p",null,[d(o("input",{"onUpdate:modelValue":e[2]||(e[2]=t=>s.password=t),placeholder:"password",type:"password"},null,512),[[u,s.password]])]),j,s.loadingForm?(n(),l("div",A)):k("",!0)],32)]))]))])}const P=c(v,[["render",F]]);export{P as default};
